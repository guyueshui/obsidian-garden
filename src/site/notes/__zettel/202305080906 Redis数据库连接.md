---
{"dg-publish":true,"permalink":"/zettel/202305080906-redis/","title":202305080906,"tags":["work","hw"],"created":"2023-05-08T09:06:21+08:00"}
---


每个微服务每套环境的数据库都是互相独立的。例如连接UniNetworkResourceService的redis数据库，可在管理面查看相关信息：

![](http://image.huawei.com/tiny-lts/v1/images/2caa15f6ae834b6d39d29ac7ab57722e_2271x627.png)

登录相应机器，找到数据库配置：
```bash
cat /opt/oss/manager/var/tenants/FabricInsight/containerlist.json | grep -A 8 "nrservicerdb"
```
![](http://image.huawei.com/tiny-lts/v1/images/ba86f4e06a919587d20d9efcf9c0652e_1542x627.png)

将上述`dbUserPasswd`替换到下面的代码中，解出密码明文：
```bash
su - ossadm -c "source /opt/oss/manager/bin/engr_profile.sh;python -c \"from util import ossext;plainText=ossext.Cipher.decrypt('AAAAHgAAAAAAAADxBV7EpwAAAAkWajKquyo7T3WGvR+lO0+ePKMvCqnSnwRHbyGIAAAAAAEAAAEAAAAAAAAAIOqJ1ECwyimR01f/DUNZ15NB6JEn9ZBp7TiOoPBkPdAq');print(plainText)\""
```

用上面获取到的密码，登录redis，
```bash
cd /opt/redis/bin
./redis-cli -h <ip> -p <port> -cipherdir /opt/redis/etc/cipher/1 -a nrservicerdb@ossdbuser@<password>

# 例如
./redis-cli -h 10.136.242.106 -p 26688 -cipherdir /opt/redis/etc/cipher/1 -a nrservicerdb@ossdbuser@07~}*0R}yN_1h#/a
```

另外，项目代码中也有封装好的操作redis的接口，搜索RedisUtil即可。

Redis教程参考：http://3ms.huawei.com/km/groups/2027333/blogs/details/13304815